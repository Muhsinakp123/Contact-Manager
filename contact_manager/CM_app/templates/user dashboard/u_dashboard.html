{% extends "master.html" %}

{% block title %}
Contact List
{% endblock %}

{% block content %}
<div class="container">
  <div class="user-card">
    <div class="user-card-header">
      <h2>Welcome, {{ request.user.username }}</h2>
      <div class="user-actions">
        <div class="user-card-profile" onclick="toggleUserProfilePopup()">
          <i class="fa-solid fa-user-circle"></i>
        </div>
        <a href="{% url 'logout' %}" onclick="return confirmLogout()" class="logout-btn">Logout</a>
      </div>
    </div>

    <div class="user-card-popup" id="userProfilePopup">
  <div class="popup-header">
    <h4>User Details</h4>
    <!-- Close Icon -->
    <i class="fa-solid fa-xmark close-icon" onclick="toggleUserProfilePopup()" title="Close"></i>
  </div>

  <p><strong>Username:</strong> {{ request.user.username }}</p>
  <p><strong>Email:</strong> {{ request.user.email }}</p>

  <!-- Action Icons -->
  <div class="user-popup-actions">
    <!-- Update icon -->
    <a href="{% url 'update_user' request.user.id %}" title="Update Profile">
      <i class="fa-solid fa-pen-to-square" style="color:rgb(243, 125, 7);"></i>
    </a>

    <!-- Delete icon -->
    <a href="{% url 'delete_user' request.user.id %}" title="Delete Account"
      onclick="return confirm('Are you sure you want to delete your account?');">
      <i class="fa-solid fa-trash" style="color:red;"></i>
    </a>
  </div>
</div>





    <!-- Add Contacts Button -->
    <p>
      <a href="{% url 'add_contact' %}" class="btn btn-add">+ Add Contacts</a>
    </p>

    <!--  All Contact List Header -->
    <div class="header">
      <h1>All Contact List</h1>
    </div>

    <!-- Contacts Table -->
    <table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Username</th>
      <th>Email</th>
      <th>Phone No</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for contact in contacts %}
    <tr>
      <td>{{ contact.id }}</td>
      <td>{{ contact.name }}</td>
      <td>{{ contact.email }}</td>
      <td>{{ contact.phone }}</td> 
      <td>
        <a href="{% url 'update_contact' contact.id %}" class="btn btn-update">Update</a>
        <a href="{% url 'delete_contact' contact.id %}" class="btn btn-delete"
          onclick="return confirm('Are you sure you want to delete this contact?');">Delete</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="5" style="text-align:center; color: rgb(142, 144, 147);">
        No contacts found
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>


  </div>

  <script>
    function toggleUserProfilePopup() {
      document.getElementById("userProfilePopup").classList.toggle("show");
    }

    function confirmLogout() {
      return confirm("Are you sure you want to log out?");
    }
  </script>
  {% endblock %}